# 10.2 Input Validation

> *"Never trust user input."* ‚Äî **The Golden Rule of Security**

‡∏Å‡∏é‡πÄ‡∏´‡∏•‡πá‡∏Å‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡πÄ‡∏ß‡πá‡∏ö‡∏Ñ‡∏∑‡∏≠ **"‡∏≠‡∏¢‡πà‡∏≤‡πÑ‡∏ß‡πâ‡πÉ‡∏à‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà User ‡∏™‡πà‡∏á‡∏°‡∏≤"** ‡∏Ñ‡∏£‡∏±‡∏ö ü§®
‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏ä‡πà‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏Å‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å, ‡∏ä‡πà‡∏≠‡∏á‡∏Ñ‡∏≠‡∏°‡πÄ‡∏°‡∏ô‡∏ï‡πå ‡∏´‡∏£‡∏∑‡∏≠‡∏ä‡πà‡∏≠‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤
Hacker ‡∏à‡πâ‡∏≠‡∏á‡∏à‡∏∞‡πÄ‡∏•‡πà‡∏ô‡∏á‡∏≤‡∏ô‡∏£‡∏π‡∏£‡∏±‡πà‡∏ß‡πÄ‡∏´‡∏•‡πà‡∏≤‡∏ô‡∏µ‡πâ‡πÄ‡∏™‡∏°‡∏≠ (SQL Injection, XSS)
‡∏´‡∏£‡∏∑‡∏≠‡πÅ‡∏°‡πâ‡πÅ‡∏ï‡πà User ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ‡∏Å‡πá‡∏≠‡∏≤‡∏à‡∏à‡∏∞‡πÄ‡∏ú‡∏•‡∏≠‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏¥‡∏î‡πÜ ‡∏°‡∏≤ (‡πÄ‡∏ä‡πà‡∏ô ‡∏ä‡πà‡∏≠‡∏á‡∏≠‡∏≤‡∏¢‡∏∏‡πÉ‡∏™‡πà‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠, ‡∏ä‡πà‡∏≠‡∏á‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏•‡∏∑‡∏°‡∏û‡∏¥‡∏°‡∏û‡πå @)

‡∏ñ‡πâ‡∏≤‡πÄ‡∏£‡∏≤‡πÄ‡∏≠‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏¥‡∏î‡πÜ ‡∏•‡∏á Database -> ‡∏£‡∏∞‡∏ö‡∏ö‡∏û‡∏±‡∏á!
‡∏î‡∏±‡∏á‡∏ô‡∏±‡πâ‡∏ô‡πÄ‡∏£‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ "‡∏¢‡∏≤‡∏°" ‡∏Ñ‡∏≠‡∏¢‡∏ï‡∏£‡∏ß‡∏à‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Ç‡πâ‡∏≤ (Input Validation) ‡∏Ñ‡∏£‡∏±‡∏ö

‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡πÑ‡∏•‡∏ö‡∏£‡∏≤‡∏£‡∏µ **`express-validator`** ‡∏ã‡∏∂‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏¢‡∏≠‡∏î‡∏ô‡∏¥‡∏¢‡∏°‡πÉ‡∏ô‡πÇ‡∏•‡∏Å Express.js üõ°Ô∏è

---

## üõ†Ô∏è Setup

```bash
npm install express-validator
```

---

## üß± Basic Validation Chain

‡πÄ‡∏£‡∏≤‡∏ô‡∏¥‡∏¢‡∏°‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô Validation ‡πÄ‡∏õ‡πá‡∏ô "Chain" (‡πÇ‡∏ã‡πà‡∏Ç‡πâ‡∏≠‡∏ï‡πà‡∏≠) ‡πÉ‡∏™‡πà‡πÑ‡∏ß‡πâ‡πÄ‡∏õ‡πá‡∏ô Middleware ‡πÉ‡∏ô Route ‡∏Å‡πà‡∏≠‡∏ô‡∏à‡∏∞‡∏ñ‡∏∂‡∏á Controller

```javascript
const { body, validationResult } = require('express-validator');

app.post('/register', [
  // --- ‡∏Å‡∏é‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à (Validation Rules) ---
  
  // 1. ‡∏ï‡∏£‡∏ß‡∏à username: ‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏á + ‡∏¢‡∏≤‡∏ß 5 ‡∏ï‡∏±‡∏ß‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ
  body('username')
    .notEmpty().withMessage('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ')
    .isLength({ min: 5 }).withMessage('‡∏ä‡∏∑‡πà‡∏≠‡∏ï‡πâ‡∏≠‡∏á‡∏¢‡∏≤‡∏ß 5 ‡∏ï‡∏±‡∏ß‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ'),

  // 2. ‡∏ï‡∏£‡∏ß‡∏à email: ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô format email ‡∏à‡∏£‡∏¥‡∏á‡πÜ
  body('email')
    .isEmail().withMessage('‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á'),

  // 3. ‡∏ï‡∏£‡∏ß‡∏à password: ‡∏¢‡∏≤‡∏ß 6 ‡∏ï‡∏±‡∏ß + ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç
  body('password')
    .isLength({ min: 6 }).withMessage('‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏¢‡∏≤‡∏ß 6 ‡∏ï‡∏±‡∏ß‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ')
    .matches(/\d/).withMessage('‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 1 ‡∏ï‡∏±‡∏ß'),

  // 4. ‡∏ï‡∏£‡∏ß‡∏à age: ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç + ‡∏´‡πâ‡∏≤‡∏°‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ 18
  body('age')
    .isInt({ min: 18 }).withMessage('‡∏≠‡∏≤‡∏¢‡∏∏‡∏ï‡πâ‡∏≠‡∏á 18 ‡∏õ‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô‡πÑ‡∏õ')

], (req, res) => {
  // --- ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå (Handling Results) ---
  
  const errors = validationResult(req);
  
  // ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ error ‡πÅ‡∏°‡πâ‡πÅ‡∏ï‡πà‡∏Ç‡πâ‡∏≠‡πÄ‡∏î‡∏µ‡∏¢‡∏ß...
  if (!errors.isEmpty()) {
    // ‡∏™‡πà‡∏á‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏ö‡∏≠‡∏Å User ‡πÄ‡∏•‡∏¢ (Bad Request 400)
    return res.status(400).json({ 
      success: false,
      errors: errors.array() // ‡∏™‡πà‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ error ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ
    });
  }

  // ‡∏ñ‡πâ‡∏≤‡∏ú‡πà‡∏≤‡∏ô‡∏´‡∏°‡∏î -> ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ï‡πà‡∏≠ (Save ‡∏•‡∏á DB)
  res.send("Registration Successful! üéâ");
});
```

---

## üßπ Sanitization (‡∏Å‡∏≤‡∏£‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•)

‡∏Å‡∏≤‡∏£ "‡∏ï‡∏£‡∏ß‡∏à" ‡∏ß‡πà‡∏≤‡∏ñ‡∏π‡∏Å‡πÑ‡∏´‡∏° ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ß‡πà‡∏≤ **Validation** (‡∏ú‡πà‡∏≤‡∏ô/‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô)
‡∏Å‡∏≤‡∏£ "‡πÅ‡∏õ‡∏•‡∏á" ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏™‡∏∞‡∏≠‡∏≤‡∏î/‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ß‡πà‡∏≤ **Sanitization** (‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ñ‡πà‡∏≤)

‡πÄ‡∏ä‡πà‡∏ô User ‡∏ä‡∏≠‡∏ö‡πÄ‡∏ú‡∏•‡∏≠‡πÄ‡∏Ñ‡∏≤‡∏∞ Spacebar ‡∏ï‡∏≠‡∏ô‡∏ó‡πâ‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠ `"somchai "` -> ‡πÄ‡∏£‡∏≤‡∏Ñ‡∏ß‡∏£‡∏ä‡πà‡∏ß‡∏¢‡∏ï‡∏±‡∏î‡∏ó‡∏¥‡πâ‡∏á‡πÉ‡∏´‡πâ

```javascript
body('email')
  .trim()             // ‡∏ï‡∏±‡∏î‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏á " test@mail.com " -> "test@mail.com"
  .normalizeEmail()   // ‡∏ó‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡πá‡∏Å‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô test@GOOGLE.com -> test@google.com
  .isEmail(),

body('comment')
  .trim()
  .escape()           // ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏°‡∏≤‡∏Å! ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏≠‡∏±‡∏Å‡∏Ç‡∏£‡∏∞ HTML ‡πÄ‡∏õ‡πá‡∏ô text ‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤ (‡∏Å‡∏±‡∏ô XSS)
                      // "<script>" -> "&lt;script&gt;"
```

---

## üß© Custom Validators

‡∏ñ‡πâ‡∏≤‡∏Å‡∏é‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô (isEmail, isLength) ‡πÑ‡∏°‡πà‡∏û‡∏≠... ‡πÄ‡∏£‡∏≤‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏Å‡∏é‡πÄ‡∏≠‡∏á‡πÑ‡∏î‡πâ! (‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏ã‡πâ‡∏≥‡πÑ‡∏´‡∏°)

```javascript
const User = require('./models/User');

body('email').custom(async (value) => {
  // ‡∏•‡∏≠‡∏á‡∏´‡∏≤‡πÉ‡∏ô DB ‡∏î‡∏π‡∏ã‡∏¥‡∏°‡∏µ‡πÑ‡∏´‡∏°?
  const existingUser = await User.findOne({ email: value });
  
  if (existingUser) {
    // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏à‡∏≠ -> ‡πÇ‡∏¢‡∏ô Error (Reject Promise)
    throw new Error('‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏ô‡∏µ‡πâ‡∏ñ‡∏π‡∏Å‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß (Email already in use)');
  }
  
  // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÄ‡∏à‡∏≠ -> ‡∏ú‡πà‡∏≤‡∏ô (Return true)
  return true;
})
```

---

## üê£ Analogy: Airport Security (‡∏à‡∏∏‡∏î‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏ô‡∏≤‡∏°‡∏ö‡∏¥‡∏ô)

- **Sanitization**: ‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ö‡∏≠‡∏Å‡πÉ‡∏´‡πâ‡∏ñ‡∏≠‡∏î‡πÄ‡∏™‡∏∑‡πâ‡∏≠‡∏Ñ‡∏•‡∏∏‡∏°, ‡∏ñ‡∏≠‡∏î‡πÄ‡∏Ç‡πá‡∏°‡∏Ç‡∏±‡∏î, ‡∏ó‡∏¥‡πâ‡∏á‡∏ô‡πâ‡∏≥‡∏î‡∏∑‡πà‡∏° (‡∏õ‡∏£‡∏±‡∏ö‡∏™‡∏†‡∏≤‡∏û‡∏ú‡∏π‡πâ‡πÇ‡∏î‡∏¢‡∏™‡∏≤‡∏£‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡∏Å‡πà‡∏≠‡∏ô‡∏ï‡∏£‡∏ß‡∏à)
- **Validation**: ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏™‡πÅ‡∏Å‡∏ô‡πÇ‡∏•‡∏´‡∏∞‡∏î‡∏±‡∏á! üö® (‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏à‡∏≠‡∏Ç‡∏≠‡∏á‡∏ï‡πâ‡∏≠‡∏á‡∏´‡πâ‡∏≤‡∏°) -> ‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà **‡∏õ‡∏è‡∏¥‡πÄ‡∏™‡∏ò** ‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡πÄ‡∏Ç‡πâ‡∏≤ (Return Error)
- **Controller**: ‡πÄ‡∏°‡∏∑‡∏≠‡∏ú‡πà‡∏≤‡∏ô‡∏î‡πà‡∏≤‡∏ô‡∏ï‡∏£‡∏ß‡∏à‡πÅ‡∏•‡πâ‡∏ß ‡∏ñ‡∏∂‡∏á‡∏à‡∏∞‡πÑ‡∏î‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡∏ô‡∏±‡πà‡∏á‡∏£‡∏≠‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á (Save to DB)

---

## üåç Real-World Pattern: Middleware Separation

‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô Validation ‡∏¢‡∏≤‡∏ß‡πÄ‡∏õ‡πá‡∏ô‡∏û‡∏£‡∏∑‡∏î‡πÉ‡∏ô `routes.js` ‡∏à‡∏∞‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÇ‡∏Ñ‡πâ‡∏î‡∏£‡∏Å‡∏°‡∏≤‡∏Å
‡πÄ‡∏£‡∏≤‡∏°‡∏≤‡πÅ‡∏¢‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏Å‡∏±‡∏ô‡∏î‡∏µ‡∏Å‡∏ß‡πà‡∏≤‡∏Ñ‡∏£‡∏±‡∏ö

```javascript
/* validators/authValidator.js */
const { body } = require('express-validator');

exports.validateRegister = [
  body('username').notEmpty().withMessage('Name required'),
  body('email').isEmail().withMessage('Invalid Email'),
  // ... ‡∏Å‡∏é‡∏≠‡∏∑‡πà‡∏ô‡πÜ ...
];

/* middleware/validateResult.js (‡πÉ‡∏ä‡πâ‡∏ã‡πâ‡∏≥‡πÑ‡∏î‡πâ‡∏ó‡∏∏‡∏Å‡∏ó‡∏µ‡πà!) */
const { validationResult } = require('express-validator');

exports.checkErrors = (req, res, next) => {
  const errors = validationResult(req);
  if (!errors.isEmpty()) {
    return res.status(400).json({ errors: errors.array() });
  }
  next();
};

/* routes/auth.js */
const { validateRegister } = require('../validators/authValidator');
const { checkErrors } = require('../middleware/validateResult');

// ‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÅ‡∏Ñ‡πà‡∏ô‡∏µ‡πâ!! ‡∏™‡∏∞‡∏≠‡∏≤‡∏î‡∏™‡∏∏‡∏î‡πÜ ‚ú®
app.post('/register', validateRegister, checkErrors, authController.register);
```

---

## ü•ä Challenges

### Level 1: Confirm Password
‡∏à‡∏á‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô Custom Validator ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö field `confirmPassword`
‡πÇ‡∏î‡∏¢‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏Ñ‡πà‡∏≤‡∏Ç‡∏≠‡∏á‡∏°‡∏±‡∏ô **‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö** field `password` ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà

::: details ‚ú® ‡πÄ‡∏â‡∏•‡∏¢
```javascript
body('confirmPassword').custom((value, { req }) => {
  // value ‡∏Ñ‡∏∑‡∏≠‡∏Ñ‡πà‡∏≤‡∏Ç‡∏≠‡∏á confirmPassword
  // req.body.password ‡∏Ñ‡∏∑‡∏≠‡∏Ñ‡πà‡∏≤‡∏Ç‡∏≠‡∏á password ‡∏´‡∏•‡∏±‡∏Å
  if (value !== req.body.password) {
    throw new Error('‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô');
  }
  return true;
})
```
:::

### Level 2: Thai Phone Number
‡∏à‡∏á‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô Validation ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡πÑ‡∏ó‡∏¢ (`phone`)
- ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏•‡πâ‡∏ß‡∏ô
- ‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏ï‡πâ‡∏ô‡∏î‡πâ‡∏ß‡∏¢ 0
- ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß 10 ‡∏´‡∏•‡∏±‡∏Å (‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠)

::: details ‚ú® ‡πÄ‡∏â‡∏•‡∏¢
```javascript
body('phone')
  .isNumeric().withMessage('‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô')
  .isLength({ min: 10, max: 10 }).withMessage('‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ 10 ‡∏´‡∏•‡∏±‡∏Å')
  .matches(/^0/).withMessage('‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏ï‡πâ‡∏ô‡∏î‡πâ‡∏ß‡∏¢ 0');
// ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ regex ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏à‡∏ö: .matches(/^0[0-9]{9}$/)
```
:::

---

## üìö Glossary

| ‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå | ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢ |
|:--------|:---------|
| **Validation** | ‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ß‡πà‡∏≤ "‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏Å‡∏é" ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà (‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà -> Error) |
| **Sanitization** | ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏≠‡∏≤‡∏î/‡πÅ‡∏õ‡∏•‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (‡πÄ‡∏ä‡πà‡∏ô ‡∏ï‡∏±‡∏î‡∏ä‡πà‡∏≠‡∏á‡∏ß‡πà‡∏≤‡∏á, ‡πÅ‡∏õ‡∏•‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡πá‡∏Å) |
| **Middleware Chain** | ‡∏Å‡∏≤‡∏£‡∏£‡πâ‡∏≠‡∏¢‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ô (express-validator ‡πÄ‡∏õ‡πá‡∏ô array ‡∏Ç‡∏≠‡∏á middleware) |
| **XSS (Cross-Site Scripting)** | ‡∏Å‡∏≤‡∏£‡πÇ‡∏à‡∏°‡∏ï‡∏µ‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏≤‡∏£‡∏ù‡∏±‡∏á script -> ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÑ‡∏î‡πâ‡∏î‡πâ‡∏ß‡∏¢ `.escape()` |
| **Custom Validator** | ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÄ‡∏≠‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö logic ‡∏ã‡∏±‡∏ö‡∏ã‡πâ‡∏≠‡∏ô (‡πÄ‡∏ä‡πà‡∏ô ‡πÄ‡∏ä‡πá‡∏Ñ Database) |

---

## üîó References

- [express-validator Docs](https://express-validator.github.io/docs/) - ‡πÅ‡∏´‡∏•‡πà‡∏á‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏´‡∏•‡∏±‡∏Å
- [Validator.js](https://github.com/validatorjs/validator.js) - ‡πÑ‡∏•‡∏ö‡∏£‡∏≤‡∏£‡∏µ‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏´‡∏•‡∏±‡∏á (‡∏î‡∏π‡∏ß‡πà‡∏≤‡∏°‡∏µ method ‡∏≠‡∏∞‡πÑ‡∏£‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡∏ö‡πâ‡∏≤‡∏á ‡πÄ‡∏ä‡πà‡∏ô isCreditCard, isURL)

---

> üëâ **‡πÑ‡∏õ‡∏ï‡πà‡∏≠: [Module 11: Security Fundamentals](/node/11-01-security-fundamentals)**
