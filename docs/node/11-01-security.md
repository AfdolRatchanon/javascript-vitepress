# 11.1 Security & Best Practices

> *"Better safe than sorry."*

‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡πÄ‡∏ß‡πá‡∏ö‡πÉ‡∏´‡πâ "‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ" ‡∏Å‡∏±‡∏ö "‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢" ‡∏ô‡∏±‡πâ‡∏ô‡∏Ñ‡∏ô‡∏•‡∏∞‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Ñ‡∏£‡∏±‡∏ö üõ°Ô∏è
‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏°‡∏≤‡∏≠‡∏∏‡∏î‡∏£‡∏π‡∏£‡∏±‡πà‡∏ß‡∏ó‡∏µ‡πà‡∏û‡∏ö‡∏ö‡πà‡∏≠‡∏¢‡πÜ ‡πÉ‡∏ô Node.js API ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡πà‡∏≠‡∏ô Deploy ‡∏Ç‡∏∂‡πâ‡∏ô Production

---

## üê£ Analogy: Castle Gate (‡∏õ‡∏£‡∏∞‡∏ï‡∏π‡πÄ‡∏°‡∏∑‡∏≠‡∏á)

‡∏ñ‡πâ‡∏≤ API ‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤‡∏Ñ‡∏∑‡∏≠ "‡πÄ‡∏°‡∏∑‡∏≠‡∏á" ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥ (Data)
- **Authentication**: ‡∏ï‡∏£‡∏ß‡∏à‡∏ö‡∏±‡∏ï‡∏£‡∏ú‡πà‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏ï‡∏π (‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏õ‡πá‡∏ô‡πÉ‡∏Ñ‡∏£?)
- **Authorization**: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏Ç‡πâ‡∏≤‡∏ß‡∏±‡∏á (‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏Ç‡πâ‡∏≤‡πÇ‡∏ã‡∏ô‡∏ô‡∏µ‡πâ‡πÑ‡∏î‡πâ‡πÑ‡∏´‡∏°?)
- **Security**:
  - ‡∏Å‡∏≥‡πÅ‡∏û‡∏á‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏ï‡πâ‡∏≠‡∏á‡∏´‡∏ô‡∏≤ (Helmet)
  - ‡∏´‡πâ‡∏≤‡∏°‡∏Ñ‡∏ô‡πÄ‡∏î‡∏¥‡∏°‡∏ß‡∏¥‡πà‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏≠‡∏≠‡∏Å‡∏ñ‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ (Rate Limit)
  - ‡∏´‡πâ‡∏≤‡∏°‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡πÅ‡∏õ‡∏•‡∏Å‡∏õ‡∏•‡∏≠‡∏°‡∏à‡∏≤‡∏Å‡∏Ñ‡∏ô‡πÅ‡∏õ‡∏•‡∏Å‡∏´‡∏ô‡πâ‡∏≤ (XSS/SQL Injection Defenses)
  - ‡∏´‡πâ‡∏≤‡∏°‡∏Ñ‡∏ô‡∏à‡∏≤‡∏Å‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏≠‡∏∑‡πà‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡∏°‡∏±‡πà‡∏ß‡∏ã‡∏±‡πà‡∏ß (CORS)

---

## üõ°Ô∏è Common Security Tools

### 1. Helmet (‡∏™‡∏ß‡∏°‡∏´‡∏°‡∏ß‡∏Å‡∏Å‡∏±‡∏ô‡∏ô‡πá‡∏≠‡∏Ñ‡πÉ‡∏´‡πâ HTTP Headers)
HTTP Headers ‡∏ö‡∏≤‡∏á‡∏ï‡∏±‡∏ß‡∏≠‡∏≤‡∏à‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ú‡∏¢‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Server ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà‡πÉ‡∏´‡πâ Hacker
`helmet` ‡∏à‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Headers ‡∏û‡∏ß‡∏Å‡∏ô‡∏µ‡πâ‡πÉ‡∏´‡πâ‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏Ç‡∏∂‡πâ‡∏ô‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥

```bash
npm install helmet
```

```javascript
const helmet = require('helmet');
app.use(helmet()); // ‡πÉ‡∏™‡πà‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡πÅ‡∏£‡∏Å‡πÜ ‡πÄ‡∏•‡∏¢
```

### 2. CORS (Cross-Origin Resource Sharing)
‡∏õ‡∏Å‡∏ï‡∏¥ Browser ‡∏à‡∏∞‡∏ö‡∏•‡πá‡∏≠‡∏Å‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡πÄ‡∏ß‡πá‡∏ö A ‡∏¢‡∏¥‡∏á Request ‡πÑ‡∏õ‡∏´‡∏≤ API B (‡∏Ñ‡∏ô‡∏•‡∏∞‡πÇ‡∏î‡πÄ‡∏°‡∏ô)
`cors` ‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡πÄ‡∏£‡∏≤‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÑ‡∏î‡πâ‡∏ß‡πà‡∏≤ "‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡πÉ‡∏´‡πâ‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏´‡∏ô‡∏°‡∏≤‡∏¢‡∏¥‡∏á API ‡πÄ‡∏£‡∏≤‡πÑ‡∏î‡πâ‡∏ö‡πâ‡∏≤‡∏á"

```bash
npm install cors
```

```javascript
const cors = require('cors');

app.use(cors({
  origin: 'https://mysite.com', // ‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡πÅ‡∏Ñ‡πà‡πÄ‡∏ß‡πá‡∏ö‡∏ô‡∏µ‡πâ
  methods: ['GET', 'POST']      // ‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡πÅ‡∏Ñ‡πà 2 ‡∏ó‡πà‡∏≤‡∏ô‡∏µ‡πâ
}));
```

### 3. Rate Limiting (‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß)
‡∏Å‡∏±‡∏ô‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏Ñ‡∏ô‡∏¢‡∏¥‡∏á API ‡∏£‡∏±‡∏ß‡πÜ (Brute Force ‡∏´‡∏£‡∏∑‡∏≠ DDoS)

```bash
npm install express-rate-limit
```

```javascript
const rateLimit = require('express-rate-limit');

const limiter = rateLimit({
  windowMs: 15 * 60 * 1000, // 15 ‡∏ô‡∏≤‡∏ó‡∏µ
  max: 100, // ‡∏¢‡∏¥‡∏á‡πÑ‡∏î‡πâ‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 100 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á
  message: "Too many requests, please try again later."
});

app.use(limiter); // ‡πÉ‡∏ä‡πâ‡∏Å‡∏±‡∏ö‡∏ó‡∏∏‡∏Å Route
// ‡∏´‡∏£‡∏∑‡∏≠‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡πÄ‡∏â‡∏û‡∏≤‡∏∞ Login Route ‡∏Å‡πá‡πÑ‡∏î‡πâ: app.post('/login', limiter, ...);
```

---

## ü¶† Common Vulnerabilities (‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà‡∏≠‡∏∑‡πà‡∏ô‡πÜ)

### 1. SQL Injection üíâ
**‡∏≠‡∏≤‡∏Å‡∏≤‡∏£**: Hacker ‡πÉ‡∏™‡πà‡πÇ‡∏Ñ‡πâ‡∏î SQL ‡∏•‡∏á‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏´‡∏•‡∏≠‡∏Å‡πÉ‡∏´‡πâ Database ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î
**‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ**: ‡πÉ‡∏ä‡πâ Prepared Statement (‡πÉ‡∏™‡πà `?`) ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ ODM/ORM (Mongoose, Sequelize)

### 2. XSS (Cross-Site Scripting) üìú
**‡∏≠‡∏≤‡∏Å‡∏≤‡∏£**: Hacker ‡πÉ‡∏™‡πà Script (`<script>alert(1)</script>`) ‡∏•‡∏á‡πÉ‡∏ô Comment ‡∏û‡∏≠‡∏Ñ‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡∏°‡∏≤‡πÄ‡∏õ‡∏¥‡∏î‡∏≠‡πà‡∏≤‡∏ô Script ‡∏Å‡πá‡∏ó‡∏≥‡∏á‡∏≤‡∏ô
**‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ**:
- ‡∏ù‡∏±‡πà‡∏á Backend: Sanitize input (‡∏•‡∏ö tag ‡∏≠‡∏≠‡∏Å)
- ‡∏ù‡∏±‡πà‡∏á Frontend: React/Vue ‡∏à‡∏∞ Escape ‡πÉ‡∏´‡πâ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ (‡πÅ‡∏ï‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏∞‡∏ß‡∏±‡∏á `dangerouslySetInnerHTML`)

### 3. Environmental Variables üîë
**‡∏´‡πâ‡∏≤‡∏°** Hardcode ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏±‡∏ö‡∏•‡∏á‡πÉ‡∏ô‡πÇ‡∏Ñ‡πâ‡∏î (‡πÄ‡∏ä‡πà‡∏ô Password DB, API Key)
**‡∏ï‡πâ‡∏≠‡∏á** ‡πÄ‡∏Å‡πá‡∏ö‡πÉ‡∏ô `.env` ‡πÅ‡∏•‡∏∞‡πÄ‡∏û‡∏¥‡πà‡∏° `.env` ‡∏•‡∏á‡πÉ‡∏ô `.gitignore` ‡πÄ‡∏™‡∏°‡∏≠!

---

## ü•ä Challenges

### Level 1: Secure Headers Check
‡∏•‡∏≠‡∏á‡πÉ‡∏ä‡πâ‡πÄ‡∏ß‡πá‡∏ö [securityheaders.com](https://securityheaders.com/) ‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ß‡πá‡∏ö‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á (‡∏ñ‡πâ‡∏≤ Deploy ‡πÅ‡∏•‡πâ‡∏ß) ‡∏´‡∏£‡∏∑‡∏≠‡∏•‡∏≠‡∏á `curl -I http://localhost:3000` ‡∏î‡∏π Headers
- ‡∏Å‡πà‡∏≠‡∏ô‡πÉ‡∏™‡πà Helmet: ‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô `X-Powered-By: Express` (‡∏ö‡∏≠‡∏Å‡∏¢‡∏µ‡πà‡∏´‡πâ‡∏≠ Server ‡πÉ‡∏´‡πâ Hacker ‡∏£‡∏π‡πâ)
- ‡∏´‡∏•‡∏±‡∏á‡πÉ‡∏™‡πà Helmet: Header ‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏´‡∏≤‡∏¢‡πÑ‡∏õ ‚úÖ

---

## üìö Glossary

| ‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå | ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢ |
|:--------|:---------|
| **CORS** | ‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏Ç‡∏≠‡∏á Browser ‡∏ó‡∏µ‡πà‡∏Å‡∏±‡∏ô‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡πÄ‡∏ß‡πá‡∏ö‡∏Ç‡πâ‡∏≤‡∏°‡πÇ‡∏î‡πÄ‡∏°‡∏ô‡∏Ç‡πÇ‡∏°‡∏¢‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏±‡∏ô |
| **DDoS** | ‡∏Å‡∏≤‡∏£‡πÇ‡∏à‡∏°‡∏ï‡∏µ‡πÇ‡∏î‡∏¢‡∏Å‡∏≤‡∏£‡∏£‡∏∞‡∏î‡∏°‡∏¢‡∏¥‡∏á Request ‡πÉ‡∏™‡πà Server ‡∏à‡∏ô‡∏•‡πà‡∏° |
| **Brute Force** | ‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏≤‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÇ‡∏î‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏∏‡πà‡∏°‡∏¢‡∏¥‡∏á‡πÑ‡∏õ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏¢‡πÜ (‡πÅ‡∏Å‡πâ‡∏î‡πâ‡∏ß‡∏¢ Rate Limit) |
| **XSS** | ‡∏Å‡∏≤‡∏£‡∏ù‡∏±‡∏á Script ‡∏£‡πâ‡∏≤‡∏¢‡∏•‡∏á‡πÑ‡∏õ‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö |
| **Sanitization** | ‡∏Å‡∏≤‡∏£‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Input ‡πÉ‡∏´‡πâ‡∏™‡∏∞‡∏≠‡∏≤‡∏î‡∏Å‡πà‡∏≠‡∏ô‡∏ô‡∏≥‡πÑ‡∏õ‡πÉ‡∏ä‡πâ |
| **Environment Variable** | ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏£‡∏∞‡∏ö‡∏ö (`process.env`) ‡πÉ‡∏ä‡πâ‡πÄ‡∏Å‡πá‡∏ö‡∏Ñ‡πà‡∏≤ config ‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÑ‡∏õ‡∏ï‡∏≤‡∏°‡∏™‡∏†‡∏≤‡∏û‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏° |

---

> üëâ **‡πÑ‡∏õ‡∏ï‡πà‡∏≠: [Project: Secure API](/node/11-project-secure-api)**
