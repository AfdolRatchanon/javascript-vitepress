# 11.1 Security Fundamentals

> *"Security is not a product, but a process."* ‚Äî **Bruce Schneier**

‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡∏™‡∏π‡πà Module ‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏Ñ‡∏£‡∏±‡∏ö! üõ°Ô∏è
‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÄ‡∏ß‡πá‡∏ö‡πÉ‡∏´‡πâ "‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ" (Make it work) ‡∏ô‡∏±‡πâ‡∏ô‡πÑ‡∏°‡πà‡∏¢‡∏≤‡∏Å...
‡πÅ‡∏ï‡πà‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÉ‡∏´‡πâ "‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢" (Make it secure) ‡∏ô‡∏±‡πâ‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏≤‡∏®‡∏±‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏≠‡∏ö‡∏Ñ‡∏≠‡∏ö

‡πÉ‡∏ô‡∏ö‡∏ó‡∏ô‡∏µ‡πâ‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏°‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö **OWASP Top 10** ‡∏ã‡∏∂‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡∏ó‡∏µ‡πà‡∏û‡∏ö‡∏ö‡πà‡∏≠‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÅ‡∏•‡∏∞‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡πÉ‡∏ô‡πÇ‡∏•‡∏Å Web Application ‡∏Ñ‡∏£‡∏±‡∏ö

---

## üê£ Analogy: The Fortified Castle (‡∏õ‡∏£‡∏≤‡∏™‡∏≤‡∏ó‡∏õ‡πâ‡∏≠‡∏°‡∏õ‡∏£‡∏≤‡∏Å‡∏≤‡∏£)

‡∏•‡∏≠‡∏á‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö Web App ‡∏Ç‡∏≠‡∏á‡πÄ‡∏£‡∏≤‡πÄ‡∏õ‡πá‡∏ô **"‡∏õ‡∏£‡∏≤‡∏™‡∏≤‡∏ó"** ‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πá‡∏ö‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥ (Database) ‡πÑ‡∏ß‡πâ‡∏†‡∏≤‡∏¢‡πÉ‡∏ô

- ** ‡∏Å‡πç‡∏≤‡πÅ‡∏û‡∏á‡πÄ‡∏°‡∏∑‡∏≠‡∏á (HTTPS)**: ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Ñ‡∏ô‡∏ô‡∏≠‡∏Å‡∏î‡∏±‡∏Å‡∏ü‡∏±‡∏á‡∏´‡∏£‡∏∑‡∏≠‡πÅ‡∏≠‡∏ö‡∏°‡∏≠‡∏á‡∏£‡∏ñ‡∏°‡πâ‡∏≤‡∏™‡πà‡∏á‡∏Ç‡∏≠‡∏á
- ** ‡∏ó‡∏´‡∏≤‡∏£‡∏¢‡∏≤‡∏°‡∏´‡∏ô‡πâ‡∏≤‡∏õ‡∏£‡∏∞‡∏ï‡∏π (Authentication)**: ‡∏ï‡∏£‡∏ß‡∏à‡∏î‡∏π‡∏ß‡πà‡∏≤‡∏Ñ‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏°‡∏µ‡∏ö‡∏±‡∏ï‡∏£‡∏ú‡πà‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á‡πÑ‡∏´‡∏°
- ** ‡πÄ‡∏Ç‡∏ï‡∏´‡∏ß‡∏á‡∏´‡πâ‡∏≤‡∏° (Authorization)**: ‡πÅ‡∏°‡πâ‡∏à‡∏∞‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡πÑ‡∏î‡πâ ‡πÅ‡∏ï‡πà‡∏ä‡∏≤‡∏ß‡∏ö‡πâ‡∏≤‡∏ô‡∏´‡πâ‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡∏ó‡πâ‡∏≠‡∏á‡∏û‡∏£‡∏∞‡πÇ‡∏£‡∏á (Admin Zone)
- ** ‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏Ñ‡πâ‡∏ô‡∏≠‡∏≤‡∏ß‡∏∏‡∏ò (Input Validation)**: ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Ñ‡∏ô‡πÅ‡∏≠‡∏ö‡∏û‡∏Å‡∏°‡∏µ‡∏î/‡∏£‡∏∞‡πÄ‡∏ö‡∏¥‡∏î (Malicious Code) ‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡∏ó‡∏≥‡∏•‡∏≤‡∏¢‡∏Ç‡πâ‡∏≤‡∏á‡πÉ‡∏ô
- ** ‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡∏≤‡∏Å‡∏≠‡∏ô‡∏≤‡∏°‡∏±‡∏¢ (Sanitization)**: ‡∏Å‡∏£‡∏≠‡∏á‡πÄ‡∏ä‡∏∑‡πâ‡∏≠‡πÇ‡∏£‡∏Ñ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏Ñ‡∏≥‡∏û‡∏π‡∏î ‡∏Å‡πà‡∏≠‡∏ô‡∏™‡πà‡∏á‡∏™‡∏≤‡∏£‡∏ï‡πà‡∏≠ (‡∏Å‡∏±‡∏ô XSS)

‡∏ñ‡πâ‡∏≤‡πÄ‡∏£‡∏≤‡∏Ç‡∏≤‡∏î‡∏™‡∏¥‡πà‡∏á‡πÉ‡∏î‡∏™‡∏¥‡πà‡∏á‡∏´‡∏ô‡∏∂‡πà‡∏á‡πÑ‡∏õ... ‡∏õ‡∏£‡∏≤‡∏™‡∏≤‡∏ó‡∏Å‡πá‡∏≠‡∏≤‡∏à‡πÅ‡∏ï‡∏Å‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ! üè∞ üî•

---

## ü¶† Top 3 Common Vulnerabilities

‡πÄ‡∏£‡∏≤‡∏°‡∏≤‡∏î‡∏π 3 ‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà‡∏¢‡∏≠‡∏î‡∏Æ‡∏¥‡∏ï‡∏ó‡∏µ‡πà Dev ‡∏à‡∏ö‡πÉ‡∏´‡∏°‡πà‡∏°‡∏±‡∏Å‡∏û‡∏•‡∏≤‡∏î‡∏Å‡∏±‡∏ô‡∏Ñ‡∏£‡∏±‡∏ö

### 1. SQL Injection (SQLi) üíâ

**‡∏≠‡∏≤‡∏Å‡∏≤‡∏£**: Hacker ‡πÅ‡∏≠‡∏ö‡πÅ‡∏ó‡∏£‡∏Å‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á SQL ‡∏•‡∏á‡πÑ‡∏õ‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏´‡∏•‡∏≠‡∏Å‡πÉ‡∏´‡πâ Database ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ï‡∏≤‡∏°‡πÉ‡∏à‡∏ä‡∏≠‡∏ö
**(‡πÄ‡∏£‡∏≤‡∏Ñ‡∏∏‡∏¢‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ô‡∏µ‡πâ‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß‡πÉ‡∏ô‡∏ö‡∏ó MySQL ‡πÅ‡∏ï‡πà‡∏°‡∏≤‡∏¢‡πâ‡∏≥‡∏≠‡∏µ‡∏Å‡∏ó‡∏µ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏°‡∏≤‡∏Å!)**

**‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÇ‡∏à‡∏°‡∏ï‡∏µ**:
Login Form ‡∏ó‡∏µ‡πà Hacker ‡∏Å‡∏£‡∏≠‡∏Å username ‡∏ß‡πà‡∏≤: `"admin" OR 1=1 --`

```sql
-- ‡πÇ‡∏Ñ‡πâ‡∏î‡∏ó‡∏µ‡πà Dev ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô (‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á!)
SELECT * FROM users WHERE username = "$input_user" AND password = "$input_pass";

-- ‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà Database ‡πÄ‡∏´‡πá‡∏ô‡∏à‡∏≤‡∏Å Hacker
SELECT * FROM users WHERE username = "admin" OR 1=1 --" AND password = "..."
```
*(‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå: `1=1` ‡πÄ‡∏õ‡πá‡∏ô‡∏à‡∏£‡∏¥‡∏á‡πÄ‡∏™‡∏°‡∏≠ ‡πÅ‡∏•‡∏∞ `--` ‡∏Ñ‡∏∑‡∏≠‡∏Å‡∏≤‡∏£ comment ‡∏ï‡∏±‡∏î‡∏´‡∏≤‡∏á‡∏ó‡∏¥‡πâ‡∏á -> Login ‡πÑ‡∏î‡πâ‡πÄ‡∏â‡∏¢‡πÄ‡∏•‡∏¢‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏π‡πâ‡∏£‡∏´‡∏±‡∏™!)*

**‡∏ß‡∏¥‡∏ò‡∏µ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô üõ°Ô∏è**:
- ‡∏´‡πâ‡∏≤‡∏°‡∏ï‡πà‡∏≠ String SQL ‡πÄ‡∏≠‡∏á‡πÄ‡∏î‡πá‡∏î‡∏Ç‡∏≤‡∏î!
- ‡πÉ‡∏ä‡πâ **Prepared Statement** (‡∏´‡∏£‡∏∑‡∏≠ ORM) ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
- `db.query('SELECT * FROM users WHERE username = ?', [username])` ‚úÖ

### 2. Cross-Site Scripting (XSS) üìú

**‡∏≠‡∏≤‡∏Å‡∏≤‡∏£**: Hacker ‡∏ù‡∏±‡∏á‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå JavaScript (`<script>alert('Hacked')</script>`) ‡∏•‡∏á‡πÑ‡∏õ‡πÉ‡∏ô‡πÄ‡∏ß‡πá‡∏ö‡πÄ‡∏£‡∏≤ (‡πÄ‡∏ä‡πà‡∏ô ‡∏ú‡πà‡∏≤‡∏ô‡∏ä‡πà‡∏≠‡∏á Comment)
‡∏û‡∏≠ User ‡∏Ñ‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡πÄ‡∏õ‡∏¥‡∏î‡∏°‡∏≤‡πÄ‡∏à‡∏≠ -> Browser ‡∏£‡∏±‡∏ô‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡∏ô‡∏±‡πâ‡∏ô -> **‡πÇ‡∏î‡∏ô‡∏Ç‡πÇ‡∏°‡∏¢ Cookies/Session ID ‡∏™‡πà‡∏á‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏≤ Hacker**

**‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó**:
- **Stored XSS**: ‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á Database (‡πÉ‡∏Ñ‡∏£‡πÄ‡∏õ‡∏¥‡∏î‡∏°‡∏≤‡∏Å‡πá‡πÇ‡∏î‡∏ô)
- **Reflected XSS**: ‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡∏°‡∏≤‡∏Å‡∏±‡∏ö URL (‡∏´‡∏•‡∏≠‡∏Å‡πÉ‡∏´‡πâ‡πÄ‡∏´‡∏¢‡∏∑‡πà‡∏≠‡∏Å‡∏î‡∏•‡∏¥‡∏á‡∏Å‡πå)

**‡∏ß‡∏¥‡∏ò‡∏µ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô üõ°Ô∏è**:
- **Sanitize Input**: ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏Å‡πá‡∏ö (‡πÄ‡∏ä‡πà‡∏ô‡πÉ‡∏ä‡πâ `express-validator` ‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡πÑ‡∏õ)
- **Escape Output**: ‡πÅ‡∏õ‡∏•‡∏á `<` ‡πÄ‡∏õ‡πá‡∏ô `&lt;` ‡∏Å‡πà‡∏≠‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏• (Modern Framework ‡∏≠‡∏¢‡πà‡∏≤‡∏á React/Vue ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡πÄ‡∏≠‡∏á‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥... ‡πÅ‡∏ï‡πà‡∏ñ‡πâ‡∏≤‡πÉ‡∏ä‡πâ EJS/Pug ‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏∞‡∏ß‡∏±‡∏á)
- **Content Security Policy (CSP)**: ‡∏ö‡∏≠‡∏Å Browser ‡∏ß‡πà‡∏≤‡∏´‡πâ‡∏≤‡∏°‡∏£‡∏±‡∏ô Script ‡∏à‡∏≤‡∏Å‡πÅ‡∏´‡∏•‡πà‡∏á‡πÅ‡∏õ‡∏•‡∏Å‡∏õ‡∏•‡∏≠‡∏°

### 3. Broken Access Control üö´

**‡∏≠‡∏≤‡∏Å‡∏≤‡∏£**: ‡∏£‡∏∞‡∏ö‡∏ö‡∏°‡∏µ‡∏Å‡∏é ‡πÅ‡∏ï‡πà‡∏´‡∏•‡∏∞‡∏´‡∏•‡∏ß‡∏°... User ‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤‡πÅ‡∏≠‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå

**‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á**:
- User A (ID: 100) ‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡∏≠‡∏¢‡∏π‡πà
- User A ‡∏•‡∏≠‡∏á‡πÅ‡∏Å‡πâ URL ‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏õ‡πá‡∏ô `/api/orders/200` (‡∏ã‡∏∂‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏≠‡∏á User B)
- ‡∏£‡∏∞‡∏ö‡∏ö‡∏î‡∏±‡∏ô‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• User B ‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡πÉ‡∏´‡πâ! (‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÄ‡∏ä‡πá‡∏Ñ‡πÅ‡∏Ñ‡πà‡∏ß‡πà‡∏≤ "‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡∏¢‡∏±‡∏á" ‡πÅ‡∏ï‡πà‡∏•‡∏∑‡∏°‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤ "‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡πÑ‡∏´‡∏°")

**‡∏ß‡∏¥‡∏ò‡∏µ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô üõ°Ô∏è**:
- ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏ä‡πá‡∏Ñ Ownership ‡πÄ‡∏™‡∏°‡∏≠
- `SELECT * FROM orders WHERE id = ? AND user_id = ?` (‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡∏≠‡∏á User ‡∏Ñ‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô)

---

## ‚öôÔ∏è Security Misconfiguration

‡∏≠‡∏µ‡∏Å‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏ï‡∏Å‡∏°‡πâ‡∏≤‡∏ï‡∏≤‡∏¢‡∏Å‡∏±‡∏ô‡∏ö‡πà‡∏≠‡∏¢‡∏Ñ‡∏∑‡∏≠ **"‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÑ‡∏°‡πà‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢"** ‡∏Ñ‡∏£‡∏±‡∏ö

### 1. Error Information Exposure üìâ
‡πÉ‡∏ô Dev Mode: ‡πÄ‡∏ß‡∏•‡∏≤ Error ‡πÄ‡∏£‡∏≤‡πÄ‡∏´‡πá‡∏ô Stack Trace ‡∏¢‡∏≤‡∏ß‡πÄ‡∏´‡∏¢‡∏µ‡∏¢‡∏î (‡∏ö‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå‡πÑ‡∏´‡∏ô ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡πÑ‡∏´‡∏ô) -> ‡∏î‡∏µ‡πÅ‡∏•‡πâ‡∏ß ‡∏à‡∏∞‡πÑ‡∏î‡πâ‡πÅ‡∏Å‡πâ‡∏ö‡∏±‡πä‡∏Å‡∏á‡πà‡∏≤‡∏¢
‡πÉ‡∏ô Production: **‡∏´‡πâ‡∏≤‡∏°‡πÇ‡∏ä‡∏ß‡πå‡πÄ‡∏î‡πá‡∏î‡∏Ç‡∏≤‡∏î!** Hacker ‡∏à‡∏∞‡∏£‡∏π‡πâ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á Folder ‡πÅ‡∏•‡∏∞ Library ‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡πÉ‡∏ä‡πâ

**‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ**:
‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Environment Variable `NODE_ENV=production`
‡πÅ‡∏•‡∏∞‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô Global Error Handler ‡πÉ‡∏´‡πâ‡∏™‡πà‡∏á‡πÅ‡∏Ñ‡πà "Something went wrong" ‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏Å‡∏¥‡∏î Server Error

### 2. Default Passwords üîë
MySQL, MongoDB, Router, Admin Panel... ‡πÑ‡∏î‡πâ‡∏°‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏á ‡πÉ‡∏ä‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏á‡∏±‡πâ‡∏ô (`root`, `admin`)
**‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ**: ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡∏ó‡∏µ‡πà‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á!

### 3. Missing Security Headers ü§Ø
HTTP Header ‡∏°‡∏µ‡∏´‡∏•‡∏≤‡∏¢‡∏ï‡∏±‡∏ß‡∏ó‡∏µ‡πà‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡πÉ‡∏´‡πâ Browser ‡πÑ‡∏î‡πâ (‡πÄ‡∏ä‡πà‡∏ô HSTS, X-Frame-Options)
‡πÅ‡∏ï‡πà Express ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÉ‡∏™‡πà‡∏°‡∏≤‡πÉ‡∏´‡πâ‡πÇ‡∏î‡∏¢ Default
**‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ**: ‡πÉ‡∏ä‡πâ Middleware ‡∏ä‡∏∑‡πà‡∏≠ **Helmet** (‡πÉ‡∏ô‡∏ö‡∏ó‡∏ñ‡∏±‡∏î‡πÑ‡∏õ)

---

## üîë Hardcoded Secrets (‡∏´‡∏≤‡∏¢‡∏ô‡∏∞‡∏ó‡∏µ‡πà‡πÅ‡∏ó‡πâ‡∏ó‡∏£‡∏π)

‡∏´‡πâ‡∏≤‡∏°... ‡∏´‡πâ‡∏≤‡∏°‡πÄ‡∏î‡πá‡∏î‡∏Ç‡∏≤‡∏î... ‡∏´‡πâ‡∏≤‡∏°‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô API Key, Password, Token Secret ‡∏•‡∏á‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå Code (.js) üôÖ‚Äç‚ôÇÔ∏è

```javascript
// ‚ùå WRONG!
const dbPassword = "superSecretPassword123";
const jwtSecret = "mySecretKey";
```

‡∏ñ‡πâ‡∏≤‡πÄ‡∏ú‡∏•‡∏≠ Push ‡∏Ç‡∏∂‡πâ‡∏ô GitHub ‡∏õ‡∏∏‡πä‡∏ö... bot ‡∏Ç‡∏≠‡∏á Hacker ‡∏à‡∏∞‡∏™‡πÅ‡∏Å‡∏ô‡πÄ‡∏à‡∏≠‡∏†‡∏≤‡∏¢‡πÉ‡∏ô‡πÑ‡∏°‡πà‡∏Å‡∏µ‡πà‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
‡πÅ‡∏•‡∏∞‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏à‡∏∞‡πÇ‡∏î‡∏ô‡∏¢‡∏∂‡∏î/‡πÄ‡∏à‡∏≤‡∏∞‡∏ó‡∏±‡∏ô‡∏ó‡∏µ!

**‚úÖ RIGHT!**:
‡πÉ‡∏ä‡πâ `.env` ‡πÅ‡∏•‡∏∞ `.gitignore` ‡πÄ‡∏™‡∏°‡∏≠!

```javascript
require('dotenv').config();
const dbPassword = process.env.DB_PASSWORD;
```

---

## ü•ä Challenges

### Level 1: Find the XSS Flaw
‡πÇ‡∏Ñ‡πâ‡∏î‡∏Ç‡πâ‡∏≤‡∏á‡∏•‡πà‡∏≤‡∏á‡∏ô‡∏µ‡πâ‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏ï‡πà‡∏≠ XSS ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£? ‡πÅ‡∏•‡∏∞‡∏à‡∏∞‡πÅ‡∏Å‡πâ‡∏¢‡∏±‡∏á‡πÑ‡∏á?

```javascript
app.get('/search', (req, res) => {
  const query = req.query.keyword;
  res.send(`<h1>Search Results for: ${query}</h1>`);
});
```

::: details ‚ú® ‡πÄ‡∏â‡∏•‡∏¢
**‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á**: ‡∏ñ‡πâ‡∏≤ User ‡∏™‡πà‡∏á `?keyword=<script>...</script>` ‡∏°‡∏≤ `res.send` ‡∏à‡∏∞‡∏™‡πà‡∏á HTML ‡∏ô‡∏±‡πâ‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ Browser ‡∏Å‡πá‡∏à‡∏∞‡∏£‡∏±‡∏ô‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
**‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ**: ‡πÉ‡∏ä‡πâ `escape-html` library ‡∏´‡∏£‡∏∑‡∏≠ `res.render` ‡∏ú‡πà‡∏≤‡∏ô View Engine ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£ Auto-escape
:::

### Level 2: Insecure Direct Object References (IDOR)
User A ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡∏•‡∏ö‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏Ç‡∏≠‡∏á User B ‡πÇ‡∏î‡∏¢‡∏Å‡∏≤‡∏£‡∏¢‡∏¥‡∏á API `DELETE /photos/555`
‡∏à‡∏á‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô Pseudo Code ‡∏Ç‡∏≠‡∏á Contoller ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏ô‡∏µ‡πâ

::: details ‚ú® ‡πÄ‡∏â‡∏•‡∏¢
```javascript
async function deletePhoto(req, res) {
  const photoId = req.params.id;
  const userId = req.user.id; // ‡πÑ‡∏≠‡∏î‡∏µ‡∏Ñ‡∏ô‡∏Å‡∏î‡∏•‡∏ö (‡∏à‡∏≤‡∏Å JWT)

  // 1. ‡∏´‡∏≤‡∏£‡∏π‡∏õ‡∏Å‡πà‡∏≠‡∏ô
  const photo = await Photo.findById(photoId);
  if (!photo) return res.status(404).send('Not found');

  // 2. üî• ‡πÄ‡∏ä‡πá‡∏Ñ‡∏î‡πà‡∏ß‡∏ô! ‡∏ß‡πà‡∏≤‡∏Ñ‡∏ô‡∏•‡∏ö ‡∏Ñ‡∏∑‡∏≠‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡∏£‡∏π‡∏õ‡∏à‡∏£‡∏¥‡∏á‡πÑ‡∏´‡∏°?
  if (photo.ownerId !== userId) {
    return res.status(403).send('Forbidden: Not your photo!');
  }

  // 3. ‡∏ñ‡πâ‡∏≤‡πÉ‡∏ä‡πà ‡∏Ñ‡πà‡∏≠‡∏¢‡∏•‡∏ö
  await photo.remove();
}
```
:::

---

## üìö Glossary

| ‡∏Ñ‡∏≥‡∏®‡∏±‡∏û‡∏ó‡πå | ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢ |
|:--------|:---------|
| **OWASP** | Open Web Application Security Project - ‡∏≠‡∏á‡∏Ñ‡πå‡∏Å‡∏£‡∏ó‡∏µ‡πà‡∏î‡∏π‡πÅ‡∏•‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡πÄ‡∏ß‡πá‡∏ö |
| **Vulnerability** | ‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà ‡∏´‡∏£‡∏∑‡∏≠‡∏à‡∏∏‡∏î‡∏≠‡πà‡∏≠‡∏ô‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏µ‡πà Hacker ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏à‡∏°‡∏ï‡∏µ‡πÑ‡∏î‡πâ |
| **Exploit** | ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏õ‡∏£‡∏∞‡πÇ‡∏¢‡∏ä‡∏ô‡πå‡∏à‡∏≤‡∏Å‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÇ‡∏à‡∏°‡∏ï‡∏µ (‡∏Å‡∏≤‡∏£‡πÄ‡∏à‡∏≤‡∏∞‡∏£‡∏∞‡∏ö‡∏ö) |
| **Zero-Day** | ‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà‡πÉ‡∏´‡∏°‡πà‡πÅ‡∏Å‡∏∞‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÉ‡∏Ñ‡∏£‡∏£‡∏π‡πâ‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ (‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢‡∏™‡∏∏‡∏î‡πÜ) |
| **Sanitize** | ‡∏Å‡∏≤‡∏£‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏Å‡∏õ‡∏£‡∏Å‡∏≠‡∏≠‡∏Å ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ |
| **IDOR** | ‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏î‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á Object ID ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå |

---

## üîó References

- [OWASP Top 10](https://owasp.org/www-project-top-ten/) - ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ 10 ‡∏ä‡πà‡∏≠‡∏á‡πÇ‡∏´‡∏ß‡πà‡∏¢‡∏≠‡∏î‡∏Æ‡∏¥‡∏ï (‡∏Ñ‡∏ß‡∏£‡∏≠‡πà‡∏≤‡∏ô!)
- [Node.js Security Best Practices](https://github.com/goldbergyoni/nodebestpractices#6-security-best-practices) - ‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏°‡∏≤‡∏Å
- [Have I Been Pwned](https://haveibeenpwned.com/) - ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤‡∏£‡∏´‡∏±‡∏™/‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡πÄ‡∏£‡∏≤‡πÄ‡∏Ñ‡∏¢‡∏´‡∏•‡∏∏‡∏î‡πÑ‡∏´‡∏°

---

> üëâ **‡πÑ‡∏õ‡∏ï‡πà‡∏≠: [Security Tools (Helmet, CORS, Rate Limit)](/node/11-02-security-tools)**
