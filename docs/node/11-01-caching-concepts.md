# 11-01: Caching Concepts âš¡

> *"There are only two hard things in Computer Science: cache invalidation and naming things."* â€” **Phil Karlton**

à¸­à¸¢à¸²à¸à¹ƒà¸«à¹‰à¹€à¸§à¹‡à¸šà¹€à¸£à¹‡à¸§à¸”à¸¸à¸ˆà¸ªà¸²à¸¢à¸Ÿà¹‰à¸²à¸Ÿà¸²à¸”à¹„à¸«à¸¡? âš¡
à¸à¸¸à¸à¹à¸ˆà¸ªà¸³à¸„à¸±à¸à¹„à¸¡à¹ˆà¹ƒà¸Šà¹ˆà¸à¸²à¸£ "à¹€à¸‚à¸µà¸¢à¸™à¹‚à¸„à¹‰à¸”à¹ƒà¸«à¹‰à¹€à¸£à¹‡à¸§à¸‚à¸¶à¹‰à¸™" à¹à¸•à¹ˆà¸„à¸·à¸­à¸à¸²à¸£ **"à¸—à¸³à¹ƒà¸«à¹‰à¸™à¹‰à¸­à¸¢à¸¥à¸‡"** à¸•à¹ˆà¸²à¸‡à¸«à¸²à¸!
à¸™à¸±à¹ˆà¸™à¸„à¸·à¸­à¸«à¸™à¹‰à¸²à¸—à¸µà¹ˆà¸‚à¸­à¸‡ **Caching** à¸„à¸£à¸±à¸š


## ðŸ£ Analogy: Backpack vs Library (à¸à¸£à¸°à¹€à¸›à¹‹à¸²à¹€à¸›à¹‰ vs à¸«à¹‰à¸­à¸‡à¸ªà¸¡à¸¸à¸”)

à¸ªà¸¡à¸¡à¸•à¸´à¸„à¸¸à¸“à¸•à¹‰à¸­à¸‡à¹€à¸‚à¸µà¸¢à¸™à¸£à¸²à¸¢à¸‡à¸²à¸™ à¹à¸¥à¸°à¸•à¹‰à¸­à¸‡à¹ƒà¸Šà¹‰à¸«à¸™à¸±à¸‡à¸ªà¸·à¸­ "History of Magic" ðŸ§™â€â™‚ï¸

1.  **No Cache (Database)**:
    - à¹€à¸”à¸´à¸™à¸­à¸­à¸à¸ˆà¸²à¸à¸šà¹‰à¸²à¸™ -> à¹„à¸›à¸«à¹‰à¸­à¸‡à¸ªà¸¡à¸¸à¸” -> à¸«à¸²à¸«à¸™à¸±à¸‡à¸ªà¸·à¸­ -> à¸¢à¸·à¸¡ -> à¹€à¸”à¸´à¸™à¸à¸¥à¸±à¸šà¸šà¹‰à¸²à¸™ -> à¸­à¹ˆà¸²à¸™
    - **à¹ƒà¸Šà¹‰à¹€à¸§à¸¥à¸²**: 1 à¸Šà¸±à¹ˆà¸§à¹‚à¸¡à¸‡ ðŸ¢

2.  **With Cache (Memory)**:
    - à¸„à¸£à¸±à¹‰à¸‡à¹à¸£à¸: à¸—à¸³à¹€à¸«à¸¡à¸·à¸­à¸™à¸‚à¹‰à¸­ 1 (à¸Šà¹‰à¸²)
    - à¹à¸•à¹ˆà¸‚à¸²à¸à¸¥à¸±à¸š **"à¹ƒà¸ªà¹ˆà¸«à¸™à¸±à¸‡à¸ªà¸·à¸­à¹„à¸§à¹‰à¹ƒà¸™à¸à¸£à¸°à¹€à¸›à¹‹à¸²à¹€à¸›à¹‰"**
    - à¸„à¸£à¸±à¹‰à¸‡à¸—à¸µà¹ˆà¸ªà¸­à¸‡: à¸¥à¹‰à¸§à¸‡à¸à¸£à¸°à¹€à¸›à¹‹à¸²à¹€à¸›à¹‰ -> à¹€à¸ˆà¸­à¹€à¸¥à¸¢!
    - **à¹ƒà¸Šà¹‰à¹€à¸§à¸¥à¸²**: 2 à¸§à¸´à¸™à¸²à¸—à¸µ ðŸš€

**Database** à¸à¹‡à¹€à¸«à¸¡à¸·à¸­à¸™à¸«à¹‰à¸­à¸‡à¸ªà¸¡à¸¸à¸” (à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹€à¸¢à¸­à¸° à¹à¸•à¹ˆà¸Šà¹‰à¸²)
**Cache** à¸à¹‡à¹€à¸«à¸¡à¸·à¸­à¸™à¸à¸£à¸°à¹€à¸›à¹‹à¸²à¹€à¸›à¹‰ (à¸—à¸µà¹ˆà¸™à¹‰à¸­à¸¢ à¹à¸•à¹ˆà¸«à¸¢à¸´à¸šà¹„à¸§à¸¡à¸²à¸)


## ðŸ’¾ Types of Caching

### 1. Client-Side Caching (Browser)
- à¹€à¸à¹‡à¸šà¸£à¸¹à¸›, CSS, JS à¹„à¸§à¹‰à¹ƒà¸™à¹€à¸„à¸£à¸·à¹ˆà¸­à¸‡ User
- **à¹„à¸¡à¹ˆà¸•à¹‰à¸­à¸‡à¹‚à¸«à¸¥à¸”à¹ƒà¸«à¸¡à¹ˆ** à¸–à¹‰à¸²à¹„à¸Ÿà¸¥à¹Œà¹€à¸”à¸´à¸¡à¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¸«à¸¡à¸”à¸­à¸²à¸¢à¸¸
- à¸„à¸§à¸šà¸„à¸¸à¸¡à¸”à¹‰à¸§à¸¢ HTTP Headers (`Cache-Control: max-age=3600`)

### 2. Server-Side Caching (à¸—à¸µà¹ˆà¹€à¸£à¸²à¸ˆà¸°à¹€à¸£à¸µà¸¢à¸™)
- à¹€à¸à¹‡à¸šà¸œà¸¥à¸¥à¸±à¸žà¸˜à¹Œà¸à¸²à¸£à¸„à¸³à¸™à¸§à¸“ à¸«à¸£à¸·à¸­ Database Query à¹„à¸§à¹‰à¹ƒà¸™ RAM à¸‚à¸­à¸‡ Server
- User A à¸‚à¸­à¸‚à¹‰à¸­à¸¡à¸¹à¸¥ -> Server à¸”à¸¶à¸‡ DB -> à¹€à¸à¹‡à¸šà¹ƒà¸ªà¹ˆ Cache -> à¸ªà¹ˆà¸‡à¹ƒà¸«à¹‰ User A
- User B à¸‚à¸­à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹€à¸”à¸´à¸¡ -> Server à¸”à¸¶à¸‡à¸ˆà¸²à¸ Cache à¸ªà¹ˆà¸‡à¹ƒà¸«à¹‰à¹€à¸¥à¸¢ (à¹„à¸¡à¹ˆà¸•à¹‰à¸­à¸‡à¸à¸§à¸™ DB)


## ðŸ†š In-Memory vs Distributed Cache

### 1. In-Memory (à¸•à¸±à¸§à¹à¸›à¸£ Global / Node Cache)
- à¹€à¸à¹‡à¸šà¹ƒà¸™à¸•à¸±à¸§à¹à¸›à¸£ `const cache = {}`
- **à¸‚à¹‰à¸­à¸”à¸µ**: à¹€à¸£à¹‡à¸§à¸—à¸µà¹ˆà¸ªà¸¸à¸” (Nanoseconds), à¹„à¸¡à¹ˆà¸•à¹‰à¸­à¸‡à¸¥à¸‡à¹‚à¸›à¸£à¹à¸à¸£à¸¡à¹€à¸žà¸´à¹ˆà¸¡
- **à¸‚à¹‰à¸­à¹€à¸ªà¸µà¸¢**:
    - à¸–à¹‰à¸² Restart Server -> à¸«à¸²à¸¢à¹€à¸à¸¥à¸µà¹‰à¸¢à¸‡! ðŸ˜±
    - à¸–à¹‰à¸²à¸¡à¸µ Server 2 à¹€à¸„à¸£à¸·à¹ˆà¸­à¸‡... Cache à¹„à¸¡à¹ˆà¸•à¸£à¸‡à¸à¸±à¸™! (User A à¹„à¸”à¹‰à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹€à¸à¹ˆà¸² User B à¹„à¸”à¹‰à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹ƒà¸«à¸¡à¹ˆ)

### 2. Distributed Cache (Redis / Memcached)
- à¹‚à¸›à¸£à¹à¸à¸£à¸¡ Database à¸—à¸µà¹ˆà¸—à¸³à¸‡à¸²à¸™à¹ƒà¸™ RAM à¹à¸¢à¸à¸­à¸­à¸à¸¡à¸²à¸•à¹ˆà¸²à¸‡à¸«à¸²à¸
- Server à¸—à¸¸à¸à¸•à¸±à¸§à¸§à¸´à¹ˆà¸‡à¸¡à¸²à¸­à¹ˆà¸²à¸™à¸—à¸µà¹ˆà¸™à¸µà¹ˆà¸—à¸µà¹ˆà¹€à¸”à¸µà¸¢à¸§
- **à¸‚à¹‰à¸­à¸”à¸µ**: à¹à¸Šà¸£à¹Œà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸à¸±à¸™à¹„à¸”à¹‰, Restart Node.js à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹„à¸¡à¹ˆà¸«à¸²à¸¢, à¹€à¸£à¹‡à¸§à¸¡à¸²à¸ (Milliseconds)
- **à¸‚à¹‰à¸­à¹€à¸ªà¸µà¸¢**: à¸•à¹‰à¸­à¸‡à¸”à¸¹à¹à¸¥ Infrastructure à¹€à¸žà¸´à¹ˆà¸¡

à¹ƒà¸™à¸„à¸­à¸£à¹Œà¸ªà¸™à¸µà¹‰à¹€à¸£à¸²à¸ˆà¸°à¹ƒà¸Šà¹‰ **Redis** à¸‹à¸¶à¹ˆà¸‡à¹€à¸›à¹‡à¸™à¸¡à¸²à¸•à¸£à¸à¸²à¸™à¸­à¸¸à¸•à¸ªà¸²à¸«à¸à¸£à¸£à¸¡à¸„à¸£à¸±à¸š ðŸ”¥


## ðŸ¥Š Challenges

### Level 1: When NOT to Cache?
à¸à¸²à¸£ Cache à¹„à¸¡à¹ˆà¹„à¸”à¹‰à¸”à¸µà¹€à¸ªà¸¡à¸­à¹„à¸›... à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹à¸šà¸šà¹„à¸«à¸™à¸—à¸µà¹ˆ **à¸«à¹‰à¸²à¸¡ Cache à¹€à¸”à¹‡à¸”à¸‚à¸²à¸”** à¸«à¸£à¸·à¸­ **à¹„à¸¡à¹ˆà¸„à¸§à¸£ Cache**?

::: details âœ¨ à¹€à¸‰à¸¥à¸¢
1.  **Real-time Data**: à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸«à¸¸à¹‰à¸™, à¸„à¹ˆà¸²à¹€à¸‡à¸´à¸™, à¸•à¸£.à¸§. à¸—à¸­à¸‡à¸„à¸³ (à¸—à¸µà¹ˆà¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¸—à¸¸à¸à¸§à¸´à¸™à¸²à¸—à¸µ)
2.  **User Specific Data**: à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ªà¹ˆà¸§à¸™à¸•à¸±à¸§ (à¸•à¸°à¸à¸£à¹‰à¸²à¸ªà¸´à¸™à¸„à¹‰à¸², à¹‚à¸›à¸£à¹„à¸Ÿà¸¥à¹Œ) *à¸–à¹‰à¸² Cache à¸•à¹‰à¸­à¸‡à¸£à¸°à¸§à¸±à¸‡à¸­à¸¢à¹ˆà¸²à¹ƒà¸«à¹‰ User A à¹€à¸«à¹‡à¸™à¸‚à¸­à¸‡ User B!*
3.  **Frequently Changing Data**: à¸–à¹‰à¸²à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹€à¸›à¸¥à¸µà¹ˆà¸¢à¸™à¸šà¹ˆà¸­à¸¢à¸à¸§à¹ˆà¸²à¸—à¸µà¹ˆ Cache à¸«à¸¡à¸”à¸­à¸²à¸¢à¸¸ User à¸ˆà¸°à¹„à¸”à¹‰à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸œà¸´à¸” (Stale Data)
:::


## ðŸ“š Glossary

| à¸„à¸³à¸¨à¸±à¸žà¸—à¹Œ | à¸„à¸§à¸²à¸¡à¸«à¸¡à¸²à¸¢ |
|:--------|:---------|
| **Cache Hit** | à¹€à¸ˆà¸­à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹ƒà¸™ Cache (à¸”à¸µà¹ƒà¸ˆà¸ˆà¸±à¸‡!) |
| **Cache Miss** | à¹„à¸¡à¹ˆà¹€à¸ˆà¸­à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹ƒà¸™ Cache (à¸•à¹‰à¸­à¸‡à¹„à¸›à¸”à¸¶à¸‡ DB à¹à¸¥à¹‰à¸§à¹€à¸­à¸²à¸¡à¸²à¹ƒà¸ªà¹ˆ Cache) |
| **TTL (Time To Live)** | à¸­à¸²à¸¢à¸¸à¸‚à¸±à¸¢à¸‚à¸­à¸‡ Cache (à¹€à¸Šà¹ˆà¸™ 60 à¸§à¸´à¸™à¸²à¸—à¸µ) à¸žà¸­à¸«à¸¡à¸”à¹€à¸§à¸¥à¸² Cache à¸ˆà¸°à¸–à¸¹à¸à¸¥à¸šà¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´ |
| **Volatile** | à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸—à¸µà¹ˆà¸«à¸²à¸¢à¹„à¸›à¹€à¸¡à¸·à¹ˆà¸­à¹„à¸Ÿà¸”à¸±à¸š (RAM) |


> ðŸ‘‰ **à¹„à¸›à¸•à¹ˆà¸­: [Redis Integration](/node/11-02-redis-integration)**
