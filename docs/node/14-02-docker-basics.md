# 14-02: Docker Basics ðŸ³

> *"Build once, Run anywhere."*

à¹€à¸„à¸¢à¹€à¸ˆà¸­à¸›à¸±à¸à¸«à¸²à¸™à¸µà¹‰à¹„à¸«à¸¡?
> *"à¹€à¸„à¸£à¸·à¹ˆà¸­à¸‡à¸œà¸¡à¸£à¸±à¸™à¹„à¸”à¹‰à¸™à¸° à¸žà¸µà¹ˆà¸¥à¸­à¸‡à¸”à¸¹à¹€à¸„à¸£à¸·à¹ˆà¸­à¸‡à¸žà¸µà¹ˆà¸ªà¸´"* ðŸ¤·â€â™‚ï¸

Docker à¹€à¸à¸´à¸”à¸¡à¸²à¹€à¸žà¸·à¹ˆà¸­à¹à¸à¹‰à¸›à¸±à¸à¸«à¸²à¸™à¸µà¹‰!
à¸¡à¸±à¸™à¸„à¸·à¸­à¸à¸²à¸£ **"à¹à¸žà¹‡à¸„à¹‚à¸„à¹‰à¸” + à¸ªà¸ à¸²à¸žà¹à¸§à¸”à¸¥à¹‰à¸­à¸¡"** (Node.js version, OS setting) à¹ƒà¸ªà¹ˆà¸à¸¥à¹ˆà¸­à¸‡ (Container)
à¹à¸¥à¹‰à¸§à¹€à¸­à¸²à¹„à¸›à¸£à¸±à¸™à¸—à¸µà¹ˆà¹„à¸«à¸™à¸à¹‡à¹„à¸”à¹‰ à¸œà¸¥à¸¥à¸±à¸žà¸˜à¹Œà¹€à¸«à¸¡à¸·à¸­à¸™à¹€à¸”à¸´à¸¡à¹€à¸›à¹Šà¸° 100%


## ðŸ“œ Dockerfile

à¹€à¸›à¸£à¸µà¸¢à¸šà¹€à¸ªà¸¡à¸·à¸­à¸™ "à¸ªà¸¹à¸•à¸£à¸­à¸²à¸«à¸²à¸£" à¸—à¸µà¹ˆà¸šà¸­à¸à¸§à¸´à¸˜à¸µà¸ªà¸£à¹‰à¸²à¸‡ Container

à¸ªà¸£à¹‰à¸²à¸‡à¹„à¸Ÿà¸¥à¹Œà¸Šà¸·à¹ˆà¸­ `Dockerfile` (à¹„à¸¡à¹ˆà¸¡à¸µà¸™à¸²à¸¡à¸ªà¸à¸¸à¸¥) à¹ƒà¸™ Project:

```dockerfile
# 1. à¹ƒà¸Šà¹‰ Node.js à¹€à¸§à¸­à¸£à¹Œà¸Šà¸±à¸™ 18 (Base Image)
FROM node:18-alpine

# 2. à¸›à¸£à¸±à¸š Timezone à¹€à¸›à¹‡à¸™à¹„à¸—à¸¢ (Optional)
RUN apk add --no-cache tzdata
ENV TZ=Asia/Bangkok

# 3. à¸à¸³à¸«à¸™à¸” Folder à¸—à¸³à¸‡à¸²à¸™à¸‚à¹‰à¸²à¸‡à¹ƒà¸™
WORKDIR /app

# 4. Copy à¹„à¸Ÿà¸¥à¹Œ package.json à¹€à¸‚à¹‰à¸²à¹„à¸›à¸à¹ˆà¸­à¸™ (à¹€à¸žà¸·à¹ˆà¸­ Cache Layer)
COPY package*.json ./

# 5. à¸•à¸´à¸”à¸•à¸±à¹‰à¸‡ dependencies
RUN npm install --production

# 6. Copy à¹‚à¸„à¹‰à¸”à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”à¹€à¸‚à¹‰à¸²à¹„à¸›
COPY . .

# 7. à¹€à¸›à¸´à¸” Port 3000
EXPOSE 3000

# 8. à¸„à¸³à¸ªà¸±à¹ˆà¸‡à¸£à¸±à¸™
CMD ["node", "app.js"]
```

à¹à¸¥à¸°à¸­à¸¢à¹ˆà¸²à¸¥à¸·à¸¡ `.dockerignore` (à¹€à¸«à¸¡à¸·à¸­à¸™ .gitignore) à¹€à¸žà¸·à¹ˆà¸­à¹„à¸¡à¹ˆà¹ƒà¸«à¹‰à¸¥à¸²à¸ `node_modules` à¹€à¸‚à¹‰à¸²à¹„à¸›à¹ƒà¸«à¹‰à¸«à¸™à¸±à¸

```text
node_modules
npm-debug.log
```


## ðŸ—ï¸ Build & Run

### 1. Build Image (à¸ªà¸£à¹‰à¸²à¸‡à¹à¸¡à¹ˆà¸žà¸´à¸¡à¸žà¹Œ)
```bash
docker build -t my-node-app .
```

### 2. Run Container (à¸›à¸±à¹Šà¸¡à¸‚à¸­à¸‡à¸­à¸­à¸à¸¡à¸²à¹ƒà¸Šà¹‰à¸‡à¸²à¸™)
- `-p 3000:3000`: à¹€à¸Šà¸·à¹ˆà¸­à¸¡ Port à¹€à¸„à¸£à¸·à¹ˆà¸­à¸‡à¹€à¸£à¸² (3000) à¸à¸±à¸š Port à¸‚à¹‰à¸²à¸‡à¹ƒà¸™ (3000)
- `-d`: à¸£à¸±à¸™à¹€à¸šà¸·à¹‰à¸­à¸‡à¸«à¸¥à¸±à¸‡ (Detach)

```bash
docker run -d -p 3000:3000 my-node-app
```

à¸•à¸­à¸™à¸™à¸µà¹‰à¹€à¸‚à¹‰à¸² `localhost:3000` à¹„à¸”à¹‰à¹€à¸¥à¸¢! ðŸŽ‰


## ðŸ™ Docker Compose

à¸–à¹‰à¸² App à¹€à¸£à¸²à¸•à¹‰à¸­à¸‡à¹ƒà¸Šà¹‰ Database (MySQL/Mongo/Redis) à¸”à¹‰à¸§à¸¢...
à¸à¸²à¸£à¸£à¸±à¸™à¸—à¸µà¸¥à¸°à¸„à¸³à¸ªà¸±à¹ˆà¸‡à¸¡à¸±à¸™à¹€à¸«à¸™à¸·à¹ˆà¸­à¸¢
à¹ƒà¸Šà¹‰ `docker-compose.yml` à¸”à¸µà¸à¸§à¹ˆà¸²!

```yaml
version: '3.8'
services:
  api:
    build: .
    ports:
      - "3000:3000"
    environment:
      - DB_HOST=db
    depends_on:
      - db

  db:
    image: mysql:5.7
    environment:
      - MYSQL_ROOT_PASSWORD=secret
      - MYSQL_DATABASE=mydb
    ports:
      - "3306:3306"
```

à¸ªà¸±à¹ˆà¸‡à¸„à¸³à¸ªà¸±à¹ˆà¸‡à¹€à¸”à¸µà¸¢à¸§... à¸—à¸¸à¸à¸­à¸¢à¹ˆà¸²à¸‡à¸‚à¸¶à¹‰à¸™à¸„à¸£à¸š! âœ¨
```bash
docker-compose up -d
```


## ðŸ“š Glossary

| à¸„à¸³à¸¨à¸±à¸žà¸—à¹Œ | à¸„à¸§à¸²à¸¡à¸«à¸¡à¸²à¸¢ |
|:--------|:---------|
| **Image** | à¹à¸¡à¹ˆà¸žà¸´à¸¡à¸žà¹Œ (Class) à¸­à¹ˆà¸²à¸™à¹„à¸”à¹‰à¸­à¸¢à¹ˆà¸²à¸‡à¹€à¸”à¸µà¸¢à¸§ à¹à¸à¹‰à¹„à¸‚à¹„à¸¡à¹ˆà¹„à¸”à¹‰ |
| **Container** | à¸Šà¸´à¹‰à¸™à¸‡à¸²à¸™à¸ˆà¸£à¸´à¸‡à¸—à¸µà¹ˆà¸–à¸¹à¸à¸ªà¸£à¹‰à¸²à¸‡à¸ˆà¸²à¸ Image (Object) à¹ƒà¸Šà¹‰à¸‡à¸²à¸™à¹„à¸”à¹‰à¸ˆà¸£à¸´à¸‡ |
| **Volume** | à¸žà¸·à¹‰à¸™à¸—à¸µà¹ˆà¹€à¸à¹‡à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸–à¸²à¸§à¸£ (à¸–à¹‰à¸²à¹„à¸¡à¹ˆà¹ƒà¸Šà¹‰ Volume à¸›à¸´à¸” Container à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸«à¸²à¸¢!) |
| **Registry** | à¸—à¸µà¹ˆà¸à¸²à¸ Image (à¹€à¸Šà¹ˆà¸™ Docker Hub) |


> ðŸ‘‰ **à¹„à¸›à¸•à¹ˆà¸­: [Project: Deployment Lab](/node/14-project-deployment)**
